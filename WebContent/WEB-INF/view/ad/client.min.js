var client = {init: function () {
    this.initEvent()
}, initEvent: function () {
    var a = this;
    $("#add_client").click(function () {
        a.newClient()
    });
    $("#update_client").click(function () {
        a.editClient()
    });
    $("#client_info_submit").unbind("click").click(function () {
        a.saveClient()
    });
    $("#search_client").click(function () {
        a.searchClient()
    });
    $("#reset_search_key").click(function () {
        $("#contact_key").val("");
        $("#company_key").val("");
        a.searchClient()
    })
}, newClient: function () {
    $("#new_client").dialog("open").dialog("setTitle", "添加广告客户");
    $("#new_client_fm").form("clear");
    Ad.data.url = "/proxy/api/ad/addClient"
}, saveClient: function () {
    Do("constant", function () {
        $("#new_client_fm").form("submit", {url: Ad.data.url, onSubmit: function () {
            return $(this).form("validate")
        }, success: function (json) {
            json = eval("(" + json + ")");
            if (json.result === constant.SYSCODE.SUCCESS) {
                $("#new_client").dialog("close");
                $("#ad_clients").datagrid("reload")
            } else {
                $.messager.show({title: "保存结果", msg: constant.messages.save_fail})
            }
        }})
    })
}, editClient: function () {
    var a = $("#ad_clients").datagrid("getSelected");
    if (a) {
        $("#new_client").dialog("open").dialog("setTitle", "修改广告客户");
        $("#new_client_fm").form("load", a);
        Ad.data.url = "/proxy/api/ad/updateClient"
    } else {
        $.messager.show({title: "提示", msg: "请选择一条客户信息！"})
    }
}, searchClient: function () {
    var b = $.trim($("#contact_key").val());
    var c = $.trim($("#company_key").val());
    var a = "/proxy/api/ad/searchClients";
    $("#ad_clients").datagrid({queryParams: {contactKey: b, companyKey: c}, url: a})
}};
$(function () {
    client.init()
});